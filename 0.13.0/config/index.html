
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Server Configuration</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/banner.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="HTTP API" href="../http/" />
    <link rel="prev" title="Pipeline and Component Configuration" href="../pipeline/" />

 <!-- Google Tag Manager -->
    <script type="opt-in" data-type="application/javascript" data-name="googletagmanager">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MMHSZCS');</script>
    <!-- End Google Tag Manager -->
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />
  <meta itemprop="image" content="https://rasa.com/assets/img/facebook-og.png">
  <meta property="og:title" content="Server Configuration" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://rasa.com/assets/img/facebook-og.png" />
  <meta property="og:url" content="https://rasa.com/docs/nlu/master/config" />
  
    <meta name="description" content="Customizing Your Rasa NLU Configuration" />
    <meta itemprop="description" content="Customizing Your Rasa NLU Configuration">
    <meta name="twitter:description" content="Customizing Your Rasa NLU Configuration" />
    <meta property="og:description" content="Customizing Your Rasa NLU Configuration" />
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@Rasa_HQ">
  <meta name="twitter:title" content="Server Configuration">
  <meta name="twitter:creator" content="@Rasa_HQ">
  <meta name="twitter:image" content="https://rasa.com/assets/img/facebook-og.png">

  <link rel="stylesheet" href="../_static/xq-light.css" type="text/css" />
  <link rel="stylesheet" href="../_static/fontawesome/css/fontawesome-all.css" type="text/css" />
  <script defer type="text/javascript" src="../_static/config.js"></script>
  <script defer type="text/javascript" src="../_static/klaro.js"></script>
  <script type="text/javascript" src="https://storage.googleapis.com/docs-theme/clipboard.min.js"></script>
  
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


  </head><body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe data-name="googletagmanager" data-src="https://www.googletagmanager.com/ns.html?id=GTM-MMHSZCS" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<div class="nav-top">
  <div class="nav-container">
    <a href="/docs" class="brand-link">
        <h1 class="brand">
            <img src="../_static/rasa_logo.svg" width="80px" height="40px" title="Rasa logo" alt="Rasa logo">
        </h1>
        <span class="logo extension">docs</span>
    </a>

    <ul class="nav">
      <input type="text" class="search" placeholder="Search">
      
        
          <li class="active"><a href=/docs/nlu/>NLU</a></li>
        
      
        
          <li><a href=/docs/core/>Core</a></li>
        
      
        
          <li><a href=/docs/platform/>Platform</a></li>
        
      

      <li>
        <a href="https://github.com/rasaHQ/" target="_blank"><button class="button btn-ghost btn-small"> <i class="fab fa-github"></i>GitHub</button></a>
      </li>

      <li>
        <a href="https://forum.rasa.com" target="_blank"><button class="button btn-small">Ask the Community</button></a>
      </li>

    </ul>
  </div>
</div>

  <div class="sidebar-extended"></div>
  <div class="document">

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/">Try It Out</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../choosing_pipeline/">Choosing a Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../entities/">Entity Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../languages/">Language Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation/">Evaluating and Improving Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fallback/">Confidence and Fallback Intents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dataformat/">Training Data Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline/">Pipeline and Component Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Server Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../http/">HTTP API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../persist/">Storing Models in the Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker/">Running in Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../customcomponents/">Custom Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migrations/">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license/">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/">Change Log</a></li>
</ul>

<div class="versions">
    <p class="caption">Versions</p>
    <div class="versions-content">
      <div>
        <span class="current-version">
          viewing: 0.13.0
        </span>
      </div>
      <div class="other-versions">
          <p>tags</p>
          <div class="dropdown-content">
              <a href="../../0.15.1/config/">0.15.1</a>
              <a href="../../0.15.0/config/">0.15.0</a>
              <a href="../../0.14.6/config/">0.14.6</a>
              <a href="../../0.14.5/config/">0.14.5</a>
              <a href="../../0.14.4/config/">0.14.4</a>
              <a href="../../0.14.3/config/">0.14.3</a>
              <a href="../../0.14.2/config/">0.14.2</a>
              <a href="../../0.14.1/config/">0.14.1</a>
              <a href="../../0.14.0/config/">0.14.0</a>
              <a href="../../0.13.8/config/">0.13.8</a>
              <a href="../../0.13.7/config/">0.13.7</a>
              <a href="../../0.13.6/config/">0.13.6</a>
              <a href="../../0.13.5/config/">0.13.5</a>
              <a href="../../0.13.4/config/">0.13.4</a>
              <a href="../../0.13.3/config/">0.13.3</a>
              <a href="../../0.13.2/config/">0.13.2</a>
              <a href="../../0.13.1/config/">0.13.1</a>
              <a href="../../0.13.0/config/">0.13.0</a>
              <a href="../../0.12.4/index/">0.12.4</a>
              <a href="../../0.12.3/config/">0.12.3</a>
              <a href="../../0.12.2/config/">0.12.2</a>
              <a href="../../0.12.1/config/">0.12.1</a>
              <a href="../../0.12.0/config/">0.12.0</a>
              <a href="../../0.11.4/config/">0.11.4</a>
              <a href="../../0.10.6/config/">0.10.6</a>
              <a href="../../0.9.2/config/">0.9.2</a>
              <a href="../../0.8.12/config/">0.8.12</a>
              <a href="../../0.7.4/config/">0.7.4</a>
          </div>
      </div>
    </div>
</div>


        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  


    
    



    <p class="scv-banner"><a href="../../0.15.1/config/"><b>Warning:</b> This document is for an old version of Rasa NLU. The latest version is 0.15.1.</a></p>
<div class="section" id="server-configuration">
<span id="section-configuration"></span><h1>Server Configuration<a class="headerlink" href="#server-configuration" title="Permalink to this headline">Â¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before you can use the server, you should train a model!
See <span class="xref std std-ref">training_your_model</span></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In older versions of Rasa NLU, the server and models were configured with a single file.
Now, the server only takes command line arguments (see <a class="reference internal" href="#server-parameters"><span class="std std-ref">Server Parameters</span></a>).
The configuration file only refers to the model that you want to train,
i.e. the pipeline and components.</p>
</div>
<div class="section" id="running-the-server">
<h2>Running the server<a class="headerlink" href="#running-the-server" title="Permalink to this headline">Â¶</a></h2>
<p>You can run a simple http server that handles requests using your projects with :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ python -m rasa_nlu.server --path projects
</pre></div>
</div>
<p>The server will look for existing projects under the folder defined by
the <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter. By default a project will load the latest
trained model.</p>
</div>
<div class="section" id="serving-multiple-apps">
<span id="section-http-config"></span><h2>Serving Multiple Apps<a class="headerlink" href="#serving-multiple-apps" title="Permalink to this headline">Â¶</a></h2>
<p>Depending on your choice of backend, Rasa NLU can use quite a lot of memory.
So if you are serving multiple models in production, you want to serve these
from the same process &amp; avoid duplicating the memory load.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although this saves the backend from loading the same set of word vectors twice,
if you have projects in multiple languages your memory usage will still be high.</p>
</div>
<p>As stated previously, Rasa NLU naturally handles serving multiple apps.
By default the server will load all projects found
under the <code class="docutils literal notranslate"><span class="pre">path</span></code> directory passed at run time.</p>
<p>Rasa NLU naturally handles serving multiple apps, by default the server will load all projects found
under the directory specified with <code class="docutils literal notranslate"><span class="pre">--path</span></code> option. unless you have provide <code class="docutils literal notranslate"><span class="pre">--pre_load</span></code> option
to load a specific project.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="c1"># This will load all projects under projects/ directory</span>
<span class="gp">$</span> python -m rasa_nlu.server -c config.yaml --path projects/
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="c1"># This will load only hotels project under projects/ directory</span>
<span class="gp">$</span> python -m rasa_nlu.server -c config.yaml --pre_load hotels --path projects/
</pre></div>
</div>
<p>The file structure under <code class="docutils literal notranslate"><span class="pre">path</span> <span class="pre">directory</span></code> is as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>- &lt;path&gt;
 - &lt;project_A&gt;
  - &lt;model_XXXXXX&gt;
  - &lt;model_XXXXXX&gt;
   ...
 - &lt;project_B&gt;
  - &lt;model_XXXXXX&gt;
   ...
  ...
</pre></div>
</div>
<p>You can specify which project to use in your <code class="docutils literal notranslate"><span class="pre">/parse</span></code> requests:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> curl <span class="s1">&#39;localhost:5000/parse?q=hello&amp;project=my_restaurant_search_bot&#39;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> curl -XPOST localhost:5000/parse -d <span class="s1">&#39;{&quot;q&quot;:&quot;I am looking for Chinese food&quot;, &quot;project&quot;:&quot;my_restaurant_search_bot&quot;}&#39;</span>
</pre></div>
</div>
<p>You can also specify the model you want to use for a given project, the default used being the latest trained:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> curl -XPOST localhost:5000/parse -d <span class="s1">&#39;{&quot;q&quot;:&quot;I am looking for Chinese food&quot;, &quot;project&quot;:&quot;my_restaurant_search_bot&quot;, &quot;model&quot;:&lt;model_XXXXXX&gt;}&#39;</span>
</pre></div>
</div>
<p>If no project is found by the server under the <code class="docutils literal notranslate"><span class="pre">path</span></code> directory, a <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code> one will be used, using a simple fallback model.</p>
</div>
<div class="section" id="server-parameters">
<span id="id1"></span><h2>Server Parameters<a class="headerlink" href="#server-parameters" title="Permalink to this headline">Â¶</a></h2>
<p>There are a number of parameters you can pass when running the server.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> python -m rasa_nlu.server
</pre></div>
</div>
<p>Here is a quick overview:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage: server.py [-h] [-e {wit,luis,dialogflow}] [-P PORT]
                 [--pre_load PRE_LOAD [PRE_LOAD ...]] [-t TOKEN] [-w WRITE]
                 --path PATH [--cors [CORS [CORS ...]]]
                 [--max_training_processes MAX_TRAINING_PROCESSES]
                 [--num_threads NUM_THREADS] [--endpoints ENDPOINTS]
                 [--wait_time_between_pulls WAIT_TIME_BETWEEN_PULLS]
                 [--response_log RESPONSE_LOG] [--storage STORAGE] [-c CONFIG]
                 [--debug] [-v]

parse incoming text

optional arguments:
  -h, --help            show this help message and exit
  -e {wit,luis,dialogflow}, --emulate {wit,luis,dialogflow}
                        which service to emulate (default: None i.e. use
                        simple built in format)
  -P PORT, --port PORT  port on which to run server
  --pre_load PRE_LOAD [PRE_LOAD ...]
                        Preload models into memory before starting the server.
                        If given `all` as input all the models will be loaded.
                        Else you can specify a list of specific project names.
                        Eg: python -m rasa_nlu.server --pre_load project1
                        --path projects -c config.yaml
  -t TOKEN, --token TOKEN
                        auth token. If set, reject requests which don&#39;t
                        provide this token as a query parameter
  -w WRITE, --write WRITE
                        file where logs will be saved
  --path PATH           working directory of the server. Models areloaded from
                        this directory and trained models will be saved here.
  --cors [CORS [CORS ...]]
                        List of domain patterns from where CORS (cross-origin
                        resource sharing) calls are allowed. The default value
                        is `[]` which forbids all CORS requests.
  --max_training_processes MAX_TRAINING_PROCESSES
                        Number of processes used to handle training requests.
                        Increasing this value will have a great impact on
                        memory usage. It is recommended to keep the default
                        value.
  --num_threads NUM_THREADS
                        Number of parallel threads to use for handling parse
                        requests.
  --endpoints ENDPOINTS
                        Configuration file for the model server as a yaml file
  --wait_time_between_pulls WAIT_TIME_BETWEEN_PULLS
                        Wait time in seconds between NLU model serverqueries.
  --response_log RESPONSE_LOG
                        Directory where logs will be saved (containing queries
                        and responses).If set to ``null`` logging will be
                        disabled.
  --storage STORAGE     Set the remote location where models are stored. E.g.
                        on AWS. If nothing is configured, the server will only
                        serve the models that are on disk in the configured
                        `path`.
  -c CONFIG, --config CONFIG
                        Default model configuration file used for training.
  --debug               Print lots of debugging statements. Sets logging level
                        to DEBUG
  -v, --verbose         Be verbose. Sets logging level to INFO
</pre></div>
</div>
</div>
<div class="section" id="authentication">
<span id="section-auth"></span><h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">Â¶</a></h2>
<p>To protect your server, you can specify a token in your Rasa NLU configuration,
by passing the <code class="docutils literal notranslate"><span class="pre">--token</span></code> argument when starting the server,
or by setting the <code class="docutils literal notranslate"><span class="pre">RASA_TOKEN</span></code> environment variable.
If set, this token must be passed as a query parameter in all requests, e.g. :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl localhost:5000/status?token<span class="o">=</span><span class="m">12345</span>
</pre></div>
</div>
</div>
<div class="section" id="cors">
<h2>CORS<a class="headerlink" href="#cors" title="Permalink to this headline">Â¶</a></h2>
<p>By default CORS (cross-origin resource sharing) calls are not allowed. If you want to call your Rasa NLU server from another domain (for example from a training web UI) then you can whitelist that domain by adding it to the config value <code class="docutils literal notranslate"><span class="pre">cors_origin</span></code>.</p>
</div>
</div>


	    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
	    <script type="text/javascript"> docsearch({
	    âapiKey: '1f9e0efb89e98543f6613a60f847b176',
	    âindexName: 'rasa',
	    âinputSelector: 'body > div.nav-top > .nav-container > .nav > input',
	    âdebug: false // Set debug to true if you want to inspect the dropdown
	    });
	    </script>
          </div>

          <div class="footer">

            <div class="social">
              <a href="https://github.com/RasaHQ" target="_blank" title="GitHub"><i class="fab fa-github"></i></a>
              <a href="https://stackoverflow.com/search?q=rasa" target="_blank" title="Stack Overflow"><i class="fab fa-stack-overflow"></i></a>
              <a href="https://www.youtube.com/channel/UCJ0V6493mLvqdiVwOKWBODQ" target="_blank" title="YouTube"><i class="fab fa-youtube"></i></a>
              <a href="https://twitter.com/rasa_hq" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a>
            </div>

            <div class="copyright small">
            &copy;2018, Rasa Technologies GmbH | <a href="https://rasa.com/imprint/" target="_blank">Imprint</a> | <a href="https://rasa.com/privacy-policy/" target="_blank">Privacy Policy</a>
            
            </div>

          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>

    

  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag(...arguments) {
      dataLayer.push(...arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-87333416-1', {
      'anonymize_ip': true,
    });
  </script>
  <script src="https://rasa.com/assets/js/js.cookies.js"></script>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script type="opt-in" data-name="googleanalytics" data-type="text/javascript" data-src="https://www.googletagmanager.com/gtag/js?id=UA-87333416-1"></script>
  <script type="opt-in" data-name="googleanalytics" data-type="text/javascript" data-src="https://rasa.com/assets/js/userId.js"></script>

  <script type="text/javascript">
    var clipboard = new ClipboardJS('.copyable');
    clipboard.on('success', function(e) {
      gtag('event', e.action, {
        'event_category': 'code',
        'event_label': e.text
      });
      const id = e.text.replace(' ','-');
      document.getElementById(id).classList.add('visible');
      setTimeout(function(){
        document.getElementById(id).classList.remove('visible');},
        800
      );
    });
    clipboard.on('error', function(e) {
      console.log(e);
    });
  </script>

  <!-- onsite anchor fix (otherwise anchors scroll to far) -->
  <script>
    /* Adapted from https://stackoverflow.com/a/13067009/1906073 */
    (function(document, history, location) {
      var HISTORY_SUPPORT = !!(history && history.pushState);

      var anchorScrolls = {
        ANCHOR_REGEX: /^#[^ ]+$/,
        OFFSET_HEIGHT_PX: 66,

        /**
         * Establish events, and fix initial scroll position if a hash is provided.
         */
        init: function() {
          this.scrollToCurrent();
          $(window).on('hashchange', $.proxy(this, 'scrollToCurrent'));
          $('body').on('click', 'a', $.proxy(this, 'delegateAnchors'));
        },

        /**
         * Return the offset amount to deduct from the normal scroll position.
         * Modify as appropriate to allow for dynamic calculations
         */
        getFixedOffset: function() {
          return this.OFFSET_HEIGHT_PX;
        },

        /**
         * If the provided href is an anchor which resolves to an element on the
         * page, scroll to it.
         * @param  {String} href
         * @return {Boolean} - Was the href an anchor.
         */
        scrollIfAnchor: function(href, pushToHistory) {
          var match, anchorOffset;

          if(!this.ANCHOR_REGEX.test(href)) {
            return false;
          }

          match = document.getElementById(href.slice(1));

          if(match) {
            anchorOffset = $(match).offset().top - this.getFixedOffset();
            $('html, body').animate({ scrollTop: anchorOffset});

            // Add the state to history as-per normal anchor links
            if(HISTORY_SUPPORT && pushToHistory) {
              history.pushState({}, document.title, location.pathname + href);
            }
          }

          return !!match;
        },

        /**
         * Attempt to scroll to the current location's hash.
         */
        scrollToCurrent: function(e) {
          if(this.scrollIfAnchor(window.location.hash) && e) {
            e.preventDefault();
          }
        },

        /**
         * If the click event's target was an anchor, fix the scroll position.
         */
        delegateAnchors: function(e) {
          var elem = e.target;

          if(this.scrollIfAnchor(elem.getAttribute('href'), true)) {
            e.preventDefault();
          }
        }
      };

      $(document).ready($.proxy(anchorScrolls, 'init'));
    })(window.document, window.history, window.location);

  </script>
  </body>
</html>